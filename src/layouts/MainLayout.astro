---
/**
 * 主布局组件
 * 提供全局布局结构
 */
import SEO from '../components/SEO.astro';
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
  keywords?: string;
  image?: string;
  noindex?: boolean;
}

const {
  title = '接触式三探头磁检测软件',
  description = '专业的工业磁粉检测系统',
  keywords,
  image,
  noindex = false,
} = Astro.props;

const fullTitle = title.includes('磁检测') ? title : `${title} - 接触式三探头磁检测软件`;
---

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <SEO
      title={fullTitle}
      description={description}
      keywords={keywords}
      image={image}
      noindex={noindex}
    />
  </head>
  <body itemscope itemtype="https://schema.org/WebApplication">
    <div class="min-h-screen flex flex-col bg-bg-primary text-text-primary">
      <!-- 顶部状态栏 -->
      <header class="h-20 bg-bg-secondary border-b-2 border-border flex items-center px-6" role="banner">
        <div class="flex items-center gap-6 w-full">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-accent-primary rounded flex items-center justify-center text-bg-primary font-bold text-xl">
              M
            </div>
            <div>
              <h1 class="text-xl font-bold">磁检测系统</h1>
              <p class="text-xs text-text-secondary">三探头磁粉检测</p>
            </div>
          </div>
          
          <div class="flex-1 flex items-center justify-center gap-6">
            <div class="flex items-center gap-2">
              <span class="status-indicator status-online"></span>
              <span class="text-sm">探头1: 在线</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="status-indicator status-online"></span>
              <span class="text-sm">探头2: 在线</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="status-indicator status-online"></span>
              <span class="text-sm">探头3: 在线</span>
            </div>
            <div class="text-sm">
              <span class="text-text-secondary">增益:</span>
              <span class="text-accent-primary font-semibold ml-1">45.5 dB</span>
            </div>
            <div class="text-sm">
              <span class="text-text-secondary">频率:</span>
              <span class="text-accent-primary font-semibold ml-1">5.0 MHz</span>
            </div>
          </div>
          
          <div class="flex items-center gap-4">
            <span class="text-sm text-text-secondary">操作员: 李工</span>
            <button class="btn-secondary btn-sm">设置</button>
          </div>
        </div>
      </header>
      
      <!-- 主内容区 -->
      <main class="flex-1 flex overflow-hidden" role="main" itemprop="mainContentOfPage">
        <!-- 左侧功能按钮区 -->
        <aside class="w-24 bg-bg-secondary border-r-2 border-border flex flex-col py-4 gap-2" role="navigation" aria-label="主导航菜单">
          <a href="/" class="btn-primary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-2xl">📊</span>
            <span class="text-xs">DISP</span>
          </a>
          <a href="/workpiece" class="btn-secondary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-2xl">🎯</span>
            <span class="text-xs">工件</span>
          </a>
          <a href="/parameters" class="btn-secondary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-2xl">⚙️</span>
            <span class="text-xs">参数</span>
          </a>
          <a href="/history" class="btn-secondary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-2xl">📜</span>
            <span class="text-xs">历史</span>
          </a>
        </aside>
        
        <!-- 中央内容区 -->
        <div class="flex-1 bg-bg-primary overflow-auto">
          <slot />
        </div>
        
        <!-- 右侧操作按钮区 -->
        <aside class="w-24 bg-bg-secondary border-l-2 border-border flex flex-col py-4 gap-2">
          <button class="btn-secondary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-2xl">↩️</span>
          </button>
          <button class="btn-primary mx-2 aspect-square flex flex-col items-center justify-center gap-1" onclick="saveRecord()">
            <span class="text-xs">SAVE</span>
          </button>
          <button class="btn-secondary mx-2 aspect-square flex flex-col items-center justify-center gap-1">
            <span class="text-xs">MENU</span>
          </button>
        </aside>
      </main>
      
      <!-- 底部控制栏 -->
      <footer class="h-16 bg-bg-secondary border-t-2 border-border flex items-center justify-center px-6 gap-4" role="contentinfo">
        <a href="/workpiece" class="btn-secondary">工件管理</a>
        <a href="/parameters" class="btn-secondary">参数配置</a>
        <a href="/history" class="btn-secondary">历史记录</a>
        <a href="/reports" class="btn-secondary">报告管理</a>
        <div class="flex-1"></div>
        <button class="btn-primary" data-action="start" onclick="window.startDetection && window.startDetection()">开始检测</button>
        <button class="btn-danger" data-action="stop" onclick="window.stopDetection && window.stopDetection()">停止</button>
      </footer>
    </div>
    
    <script>
      // 全局函数
      (window as any).saveRecord = () => {
        alert('保存功能：将当前检测数据保存到数据库');
      };
    </script>
  </body>
</html>